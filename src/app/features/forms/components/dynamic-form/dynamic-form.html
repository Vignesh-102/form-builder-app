<div class="builder-container">
  <!-- Sidebar Toolbox -->
  <div id="toolbox" class="toolbox" cdkDropList [cdkDropListData]="toolboxFields" [cdkDropListConnectedTo]="['canvas']">
    <h3>Field Toolbox</h3>
    <p class="toolbox-desc">👉 Drag a field from here and drop it into the canvas to add it to the form.</p>

    @for (item of toolboxFields; track item) {
    <div class="toolbox-item" cdkDrag>
      {{ item.label }}
      <button [disabled]="previewMode" type="button" class="add-btn" (click)="addFieldFromToolbox(item)">
        + Add
      </button>
    </div>
    }
  </div>

  <!-- Canvas -->
  <div id="canvas" class="canvas" cdkDropList #canvas="cdkDropList" [cdkDropListData]="(fields$ | async)!"
    [cdkDropListConnectedTo]="['toolbox']" (cdkDropListDropped)="onDrop($event)">
    <h2 class="canvas-heading">📝 Canvas</h2>

    <!-- Form Name Input -->
    <div class="form-name">
      <input class="form-name-input" type="text" [(ngModel)]="formName" placeholder="Enter form name"
        [disabled]="previewMode" />
    </div>

    <!-- Toggle buttons -->
    <div class="actions">
      <button type="button" (click)="togglePreview()" [disabled]="(fields$ | async)?.length === 0">
        {{ previewMode ? 'Back to Builder' : 'Preview' }}
      </button>
    </div>

    <!-- Builder Mode -->
    @if (!previewMode) {
    <app-builder-mode></app-builder-mode>
    }

    <!-- Preview Mode -->
    @if (previewMode) {
    <app-preview-mode></app-preview-mode>
    }
  </div>
</div>